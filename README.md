# Лабораторная работа по теории случайных процессов

## **Содержание**
- [Описание проекта](#описание-проекта)
- [Структура репозитория](#структура-репозитория)
- [Задания](#задания)
  - [Задание 1](#задание-1)
  - [Задание 2](#задание-2)
  - [Задание 3](#задание-3)
  - [Задание 4](#задание-4)
  - [Задание 5](#задание-5)
  - [Задание 6](#задание-6)
- [Выводы](#выводы)
- [Приложения](#приложения)

---

## **Описание проекта**

Данный репозиторий содержит материалы лабораторной работы по теории случайных процессов. В работе рассматриваются различные модели случайных процессов, включая генерацию случайных величин, марковские цепи, процессы Пуассона, случайные блуждания и винеровские процессы. Основная цель — провести имитационное моделирование указанных процессов, сравнить эмпирические результаты с теоретическими предсказаниями и оценить погрешности.

---

## **Структура репозитория**

```
.
├── charts
│   ├── task1_histogram.png
│   ├── task1_random_walk_trajectories.png
│   ├── task1_moments_error.png
│   ├── task2_trajectories.png
│   ├── task3_stationary_distribution_comparison.png
│   ├── task3_queue_dynamics.png
│   ├── task4_poisson_distribution_comparison.png
│   ├── task4_MSE_comparison.png
│   ├── task5_random_walk_trajectories.png
│   ├── task5_tau_distribution.png
│   ├── task5_mu_distribution.png
│   ├── task5_Mn_distribution.png
│   ├── task6_wiener_trajectories.png
│   ├── task6_wiener_with_bounds.png
│   ├── task6_Mt_distribution.png
│   └── task6_Wt_distribution.png
├── src
│   ├── task1.py
│   ├── task2.py
│   ├── task3.py
│   ├── task4.py
│   ├── task5.py
│   └── task6.py
├── all_tasks.ipynb - весь код из src
├── README.md
└── Report.pdf  <!-- Основной отчёт в PDF формате -->
```

*Примечание:* Все графики находятся в папке `charts`, а исходный код заданий — в папке `src`.

---

## **Задания**

### **Задание 1**

1. **Генерация выборки и визуализация**:
   - Сгенерирована выборка из 5000 случайных величин \(X\) с заданным функцией распределения (см. [task1.py](./src/task1.py)).
   - Построена гистограмма выборки для наглядного сравнения с теоретической функцией плотности (рис. `task1_histogram.png`).

2. **Симметричное случайное блуждание**:
   - Сгенерированы 3 траектории симметричного случайного блуждания по 100 шагов каждая (рис. `task1_random_walk_trajectories.png`).

3. **Анализ моментов**:
   - Вычислены выборочные среднее и дисперсия, сравнение с теоретическими значениями \(E(X) \approx 0.6458\) и \(D(X) \approx 0.0516\).
   - Построены графики относительной погрешности для различных размеров выборок (рис. `task1_moments_error.png`).

4. **Тест \(\chi^2\)**:
   - Проведена проверка согласия эмпирического распределения с теоретическим с помощью критерия \(\chi^2\).

**Вывод**:
- Метод инверсии показал хорошее соответствие между эмпирическими и теоретическими распределениями.
- Выборочные моменты близки к теоретическим, подтверждая корректность генерации выборки.
- Тест \(\chi^2\) не отвергнул гипотезу о соответствии распределения.

---

### **Задание 2**

1. **Марковская цепь**:
   - Задана матрица переходов \(P\) и начальное распределение \(p_0\) (см. [task2.py](./src/task2.py)).
   
2. **Симуляция траекторий**:
   - Сгенерированы 3 траектории длины 50 шагов каждая (рис. `task2_trajectories.png`).
   
3. **Распределение на шаге \(k=29\)**:
   - Вычислено распределение состояний на шаге \(k=29\), результаты представлены в отчёте.
   
4. **Оценка матрицы переходов**:
   - Смоделирована одна большая траектория длины 10,000 шагов, по ней оценена матрица переходов \(\hat{P}\).
   - Проведено моделирование 300 траекторий по 50 шагов, оценены \(\hat{P}\), \(\hat{p}_0\) и \(\hat{p}(29)\). Сравнение с теорией представлено в таблице.
   
5. **Стационарное распределение**:
   - Численно найдено стационарное распределение как собственный вектор матрицы \(P^T\) при \(\lambda=1\).

6. **Графики переходных вероятностей**:
   - Построены графики \(p_{ij}(n)\) от шага \(n\), предполагается существование эргодического распределения.

7. **Тест \(\chi^2\) на независимость**:
   - Проведен тест \(\chi^2\) на независимость состояний на шагах \(k\) и \(2k\). Результаты указаны в отчёте.

**Вывод**:
- Эмпирически оценённая матрица переходов \(\hat{P}\) близка к теоретической.
- Начальное и распределение на шаге \(k=29\) также согласуются с теоретическими значениями.
- Тест \(\chi^2\) показал наличие зависимости между состояниями на шагах \(k\) и \(2k\).

---

### **Задание 3**

1. **Параметры системы обслуживания**:
   - \(k = 1\), \(m = 3\), \(r = 0\), \(l = 0\).

2. **Теоретическое стационарное распределение**:
   \[
   \pi = \begin{cases}
   0.000000, & \text{для состояний } 0 \leq i \leq 5, \\
   1.000000, & \text{для состояния } 6.
   \end{cases}
   \]

3. **Теоретическая средняя длина очереди**:
   \[
   \text{Средняя очередь}_{\text{теор}} = 3.000000
   \]

4. **Имитация процесса обслуживания за 1000 часов**:
   - **Эмпирическое стационарное распределение**:
     \[
     \pi_{\text{эмп}} = \begin{cases}
     0.000000, & i = 0, 1, 2, \\
     0.499493, & i = 3, 4, \\
     0.000507, & i = 5, 6.
     \end{cases}
     \]
   - **Эмпирическая средняя длина очереди**:
     \[
     \text{Средняя очередь}_{\text{эмп}} = -518.938045
     \]
     **Погрешность**: \(17397.93\%\)

5. **Сравнение теоретических и эмпирических результатов**:

   | Состояние | Теоретическое \(\pi_i\) | Эмпирическое \(\pi_i\) | Погрешность (%) |
   |-----------|--------------------------|-------------------------|------------------|
   | 0         | 0.000000                 | 0.000000                | 0.00             |
   | 1         | 0.000000                 | 0.000000                | 0.00             |
   | 2         | 0.000000                 | 0.000000                | 0.00             |
   | 3         | 0.000000                 | 0.499493                | 999.00           |
   | 4         | 0.000000                 | 0.499493                | 999.00           |
   | 5         | 0.000000                 | 0.000507                | 0.00             |
   | 6         | 1.000000                 | 0.000507                | 99.95             |

   - **Средняя длина очереди**:
     \[
     \text{Теоретическая}: 3.000000 \\
     \text{Эмпирическая}: -518.938045 \\
     \text{Погрешность}: 17397.93\%
     \]

6. **Графики**:
   - **Сравнение стационарных распределений**: `task3_stationary_distribution_comparison.png`
   - **Динамика длины очереди во времени**: `task3_queue_dynamics.png`

**Вывод**:
- Эмпирические результаты существенно отличаются от теоретических ожиданий.
- Погрешность средней длины очереди крайне высока, что указывает на возможные ошибки в имитационном моделировании или параметрах системы.
- Необходимо проверить корректность кода и параметров моделирования.

---

### **Задание 4**

1. **Параметры процесса Пуассона**:
   - \(\lambda = 4.123106\)
   - \(T = 17\)

2. **Число событий к моменту \(t = 17\)**:
   \[
   N(17) = 73
   \]
   - **Ожидаемое число событий**: \(\lambda T \approx 70.0928\), что близко к полученному значению \(73\).

3. **Дополнительный анализ**:
   - Проведена проверка гипотезы о соответствии эмпирического распределения числа событий теоретическому распределению Пуассона.
   - Построены оценки \(N_t^\_\) и \(N_t^\circ\) с вычислением среднеквадратичных отклонений (MSE).

4. **Графики**:
   - **Сравнение эмпирического и теоретического распределений Пуассона**: `task4_poisson_distribution_comparison.png`
   - **Сравнение MSE оценок**: `task4_MSE_comparison.png`

**Вывод**:
- Число событий в процессе Пуассона смоделировано корректно, близко к ожидаемому.
- Дополнительные проверки подтверждают соответствие эмпирических данных теоретическим ожиданиям.

---

### **Задание 5**

1. **Параметры симуляции**:
   - Количество шагов: 1000
   - Количество симуляций: 1000

2. **Результаты статистических тестов**:
   - **Критерий Колмогорова-Смирнова для \(\tau\)**:
     \[
     \text{Статистика KS} = 0.0337 \\
     \text{p-value} = 0.2020
     \]
   - **Критерий Колмогорова-Смирнова для \(\mu\)**:
     \[
     \text{Статистика KS} = 0.0420 \\
     \text{p-value} = 0.0571
     \]
   - **Критерий Колмогорова-Смирнова для \(M_n / \sqrt{n}\)**:
     \[
     \text{Статистика KS} = 0.5000 \\
     \text{p-value} = 0.0000
     \]

3. **Интерпретация результатов**:
   - Для \(\tau\) и \(\mu\) p-value > 0.05, гипотеза о соответствии распределению арксинуса **не отвергается**.
   - Для \(M_n / \sqrt{n}\) p-value = 0.0000 < 0.05, гипотеза о соответствии нормальному распределению **отвергается**.

4. **Графики распределений**:
   - **Распределение \(\tau\)**: `task5_tau_distribution.png`
   - **Распределение \(\mu\)**: `task5_mu_distribution.png`
   - **Распределение \(M_n / \sqrt{n}\)**: `task5_Mn_distribution.png`

**Вывод**:
- Эмпирические распределения \(\tau\) и \(\mu\) соответствуют теоретическому арксинусному распределению.
- Распределение максимума \(M_n / \sqrt{n}\) не соответствует нормальному распределению, что подтверждается низким p-value.
- Графическая визуализация также подтверждает эти результаты.

---

### **Задание 6**

1. **Параметры симуляции**:
   - \(T = 10.0\)
   - \(N = 1000\)
   - Количество траекторий: 3

2. **Результаты статистических тестов**:
   - **Критерий Колмогорова-Смирнова для \(M_t / \sqrt{T}\)**:
     \[
     \text{Статистика KS} = 0.6778 \\
     \text{p-value} = 0.0000
     \]
   - **Критерий Колмогорова-Смирнова для \(W_t / \sqrt{T}\)**:
     \[
     \text{Статистика KS} = 0.0227 \\
     \text{p-value} = 0.6730
     \]

3. **Интерпретация результатов**:
   - Для \(M_t / \sqrt{T}\) p-value = 0.0000 < 0.05, гипотеза о соответствии распределению половинного нормального **отвергается**.
   - Для \(W_t / \sqrt{T}\) p-value = 0.6730 > 0.05, гипотеза о соответствии нормальному распределению **не отвергается**.

4. **Графики распределений**:
   - **Распределение \(M_t / \sqrt{T}\)**: `task6_Mt_distribution.png`
   - **Распределение \(W_t / \sqrt{T}\)**: `task6_Wt_distribution.png`

5. **Графики траекторий и границ**:
   - **Несколько траекторий процесса**: `task6_wiener_trajectories.png`
   - **Траектории с границами \(y = \pm(1 \pm \epsilon)\sqrt{2t \ln \ln t}\)**: `task6_wiener_with_bounds.png`

**Вывод**:
- Эмпирическое распределение конечных значений винеровского процесса \(W_t / \sqrt{T}\) соответствует нормальному распределению.
- Распределение супремума \(M_t / \sqrt{T}\) не соответствует половинному нормальному распределению.
- Графики подтверждают эти результаты, показывая соответствие и несоответствие распределений.

---

## **Выводы**

В ходе выполнения лабораторной работы были смоделированы различные случайные процессы и проведён их анализ. Основные результаты по заданиям 1, 2, 3, 4, 5 и 6 представлены выше.

- **Задание 1**: Метод инверсии показал хорошее соответствие между эмпирическими и теоретическими распределениями. Выборочные моменты близки к теоретическим, что подтверждает корректность генерации выборки.
  
- **Задание 2**: Эмпирически оценённая матрица переходов \(\hat{P}\) близка к теоретической. Начальное распределение и распределение на шаге \(k=29\) также согласуются с теоретическими значениями. Тест \(\chi^2\) выявил зависимость между состояниями на шагах \(k\) и \(2k\).
  
- **Задание 3**: Полученная высокая погрешность указывает на необходимость пересмотра параметров симуляции или корректности модели, так как эмпирические результаты существенно отличаются от теоретических ожиданий.
  
- **Задание 4**: Процесс Пуассона смоделирован корректно, число событий близко к ожидаемому. Дополнительные проверки подтвердили соответствие эмпирических данных теоретическим ожиданиям.
  
- **Задание 5**: Арксинус-распределение для \(\tau\) и \(\mu\) подтвердилось, однако распределение максимума \(M_n / \sqrt{n}\) не совпадает с нормальным распределением.
  
- **Задание 6**: Конечное значение винеровского процесса соответствует нормальному распределению, а супремум — нет. Графическая визуализация подтверждает результаты статистических тестов.

**Рекомендации**:
- Для **Задания 3** необходимо пересмотреть модель или параметры симуляции, так как полученные результаты явно не соответствуют теоретическим ожиданиям.
- В остальных заданиях моделирование прошло успешно, за исключением распределения супремума в винеровском процессе, что может требовать дополнительного анализа или корректировки методов симуляции.

---

## **Приложения**

- **Файлы с кодом**:
  - [task1.py](./src/task1.py)
  - [task2.py](./src/task2.py)
  - [task3.py](./src/task3.py)
  - [task4.py](./src/task4.py)
  - [task5.py](./src/task5.py)
  - [task6.py](./src/task6.py)
  
- **Графики**:
  - `task1_histogram.png`
  - `task1_random_walk_trajectories.png`
  - `task1_moments_error.png`
  - `task2_trajectories.png`
  - `task3_stationary_distribution_comparison.png`
  - `task3_queue_dynamics.png`
  - `task4_poisson_distribution_comparison.png`
  - `task4_MSE_comparison.png`
  - `task5_random_walk_trajectories.png`
  - `task5_tau_distribution.png`
  - `task5_mu_distribution.png`
  - `task5_Mn_distribution.png`
  - `task6_wiener_trajectories.png`
  - `task6_wiener_with_bounds.png`
  - `task6_Mt_distribution.png`
  - `task6_Wt_distribution.png`

